{% extends "base.html" %}
{% block content %}

<h1>Muokkaa kirjaa</h1>

{% with msgs = get_flashed_messages(with_categories=True) %}
  {% if msgs %}
    <ul class="messages">
      {% for cat, msg in msgs %}
        <li class="msg {{ cat }}">{{ msg }}</li>
      {% endfor %}
    </ul>
  {% endif %}
{% endwith %}

<form method="post" action="/edit_book/{{ book.id }}">
  <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">

  <label for="title">Kirjan nimi</label>
  <input id="title" name="title" value="{{ book.title }}" required maxlength="200">

  <label for="author">Kirjailija</label>
  <input id="author" name="author" value="{{ book.author }}" required maxlength="200">

  <label for="year">Julkaisuvuosi</label>
  <input id="year" name="year" type="number" value="{{ book.year or '' }}" min="-3000" max="{{ current_year }}">

  <label for="language">Kieli</label>
  <input id="language" name="language" value="{{ book.language or '' }}" maxlength="50">

  <label for="categories">Luokat</label>
  <select id="categories" name="categories" multiple size="8" required>
    {% for c in categories %}
      <option value="{{ c.id }}" {% if selected_categories and c.id in selected_categories %}selected{% endif %}>
        {{ c.name }}
      </option>
    {% endfor %}
  </select>
  <small>Pid√§ Ctrl (Windows) tai Command (Mac) pohjassa valitaksesi useita.</small>

  <div style="margin-top: 1rem;">
    <button type="submit">Tallenna muutokset</button>
    <a href="/books/{{ book.id }}">Peruuta</a>
  </div>
</form>

<style>
  .messages { list-style:none; padding:0; margin:.5rem 0; }
  .msg { padding:.5rem .75rem; margin:.25rem 0; border-radius:6px; border:1px solid #ddd; }
  .msg.success { background:#e8f8ee; border-color:#98dfb6; }
  .msg.error { background:#ffecec; border-color:#ff9d9d; }
</style>

{% endblock %}
